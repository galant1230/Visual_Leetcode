
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>572. Subtree DFS å‹•ç•«æ¨¡æ“¬å™¨</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; background: #f9f9f9; }
    h1 { text-align: center; }
    .tree { text-align: center; margin-top: 2rem; }
    .node {
      width: 40px; height: 40px;
      border: 2px solid #2980b9;
      border-radius: 50%;
      background: white; color: #2980b9;
      display: inline-flex; align-items: center; justify-content: center;
      font-weight: bold; margin: 5px;
    }
    .highlight { background: #e67e22; color: white; }
    .matched { background: #2ecc71; color: white; }
    pre { background: #f0f0f0; padding: 1rem; border-radius: 6px; overflow-x: auto; }
    .info { margin-top: 1rem; font-size: 16px; }
    button { background: #2980b9; color: white; padding: 8px 16px; border: none; border-radius: 6px; margin: 10px; }
  </style>
</head>
<body>

<h1>572. Subtree of Another Treeï½œDFS ç²¾ç°¡ç‰ˆå‹•ç•«æ¨¡æ“¬å™¨</h1>

<div style="text-align:center;">
  <label>Root æ¨¹ï¼š</label>
  <input id="rootInput" value="[3,4,5,1,2]" style="width:300px;" />
  <br><br>
  <label>SubRoot æ¨¹ï¼š</label>
  <input id="subInput" value="[4,1,2]" style="width:300px;" />
  <br><br>
  <button onclick="start()">é–‹å§‹ DFS å­æ¨¹æ¯”å°</button>
  <button onclick="next()">ä¸‹ä¸€æ­¥</button>
</div>

<div class="tree">
  <h3>ğŸŒ³ Root æ¨¹</h3>
  <div id="rootTree"></div>
  <h3>ğŸŒ¿ SubRoot æ¨¹</h3>
  <div id="subTree"></div>
</div>

<div class="info" id="info">æº–å‚™é–‹å§‹æ¯”å°</div>

<h2>ğŸ”§ ç²¾ç°¡ç‰ˆç¨‹å¼ç¢¼ (DFS)</h2>
<pre><code class="language-python">def isSubtree(root, subRoot):
    if root == None:
        return False
    if isSameTree(root, subRoot):
        return True
    return isSubtree(root.left, subRoot) or isSubtree(root.right, subRoot)

def isSameTree(p, q):
    if not p and not q: return True
    if not p or not q: return False
    return (p.val == q.val and 
            isSameTree(p.left, q.left) and 
            isSameTree(p.right, q.right))
</code></pre>

<h2>â± æ™‚é–“èˆ‡ç©ºé–“è¤‡é›œåº¦</h2>
<ul>
  <li><strong>æ™‚é–“è¤‡é›œåº¦ï¼š</strong>O(m * n)</li>
  <li><strong>ç©ºé–“è¤‡é›œåº¦ï¼š</strong>O(h)</li>
</ul>

<h2>ğŸ’¡ Tips</h2>
<ul>
  <li>é€™æ˜¯ DFS ç¶“å…¸å¯«æ³•ï¼Œç°¡å–®æ¸…æ¥šåˆå¯¦ç”¨</li>
  <li>æœƒå¾ root æ¯å€‹ç¯€é»ä¸‹å»éè¿´å˜—è©¦æ¯”å° subRoot</li>
  <li>å¯æ”¹é€²ç‚º hash æ¨¹åºåˆ—åŒ–æˆ–å­—ä¸²åŒ¹é…ï¼Œä½†æ­¤æ³•å·²è¶³å¤ æ‡‰ä»˜å¤§éƒ¨åˆ†é¢è©¦</li>
</ul>

<script>
let r = [], s = [], i = 0, steps = [], stepIndex = 0;

function parseTree(str) {
  try { return JSON.parse(str).map(v => v === null ? null : v); }
  catch { alert("è«‹è¼¸å…¥åˆæ³•é™£åˆ—"); return []; }
}

function render(id, arr) {
  const dom = document.getElementById(id);
  dom.innerHTML = "";
  arr.forEach((v, i) => {
    const n = document.createElement("div");
    n.className = "node";
    n.textContent = v === null ? "âˆ…" : v;
    n.id = id + "-" + i;
    dom.appendChild(n);
  });
}

function same(p, q) {
  if (p >= r.length || q >= s.length) return false;
  if (s[q] === null) return r[p] === null;
  if (r[p] !== s[q]) return false;
  return same(2*p+1, 2*q+1) && same(2*p+2, 2*q+2);
}

function simulate() {
  steps = [];
  for (let j = 0; j < r.length; j++) {
    steps.push({ idx: j, match: same(j, 0) });
  }
}

function next() {
  if (stepIndex >= steps.length) return;
  r.forEach((_, i) => document.getElementById("rootTree-" + i)?.classList.remove("highlight", "matched"));
  const s = steps[stepIndex++];
  const el = document.getElementById("rootTree-" + s.idx);
  if (el) el.classList.add(s.match ? "matched" : "highlight");
  document.getElementById("info").innerText =
    `ç¯€é» ${s.idx} æ¯”å°çµæœï¼š${s.match ? "âœ… æ˜¯å­æ¨¹" : "âŒ ä¸åŒ¹é…"}`;
}

function start() {
  r = parseTree(document.getElementById("rootInput").value);
  s = parseTree(document.getElementById("subInput").value);
  stepIndex = 0;
  render("rootTree", r);
  render("subTree", s);
  simulate();
  document.getElementById("info").innerText = "é–‹å§‹æ¯”å°...";
}
</script>

</body>
</html>
