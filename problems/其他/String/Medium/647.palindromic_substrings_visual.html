
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>LeetCode 647 - å›æ–‡å­å­—ä¸²</title>
  <style>
    body { font-family: sans-serif; background: #f9f9f9; padding: 2rem; }
    h1, h2 { color: #2c3e50; }
    pre.code-block { background: #2d2d2d; color: #f8f8f2; padding: 1rem; border-radius: 8px; font-family: monospace; line-height: 1.5; overflow-x: auto; }
    .highlight { background: #44475a; display: block; }
    .window-row, .pointer-row { display: flex; justify-content: center; font-family: monospace; margin: 10px 0; }
    .cell {
      width: 40px; height: 40px; border: 2px solid #ccc;
      display: flex; align-items: center; justify-content: center;
      margin: 2px; font-size: 20px; background: white;
    }
    .center { background: #d5f5e3; border-color: #27ae60; }
    .match { background: #f9e0e0; border-color: #e74c3c; }
    .label { font-size: 12px; text-align: center; width: 40px; }
    .state-box {
      text-align: center;
      margin: 1rem 0;
      font-family: monospace;
      font-size: 16px;
    }
    button { margin: 0.5rem; padding: 0.5rem 1rem; font-size: 16px; }
  </style>
</head>
<body>

<h1>ğŸ“˜ LeetCode 647 - å›æ–‡å­å­—ä¸² (Palindromic Substrings)</h1>

<h2>ğŸ”¹ é¡Œç›®æè¿°</h2>
<p>çµ¦å®šä¸€å€‹å­—ä¸² sï¼Œè«‹å›å‚³ s ä¸­çš„ <strong>å›æ–‡å­å­—ä¸²æ•¸é‡</strong>ã€‚</p>

<h2>ğŸ§  è§£æ³•ï¼šä¸­å¿ƒæ“´å±•æ³• (Expand Around Center)</h2>
<ul>
  <li>éæ­·æ¯å€‹ç´¢å¼• iï¼Œä½œç‚ºå›æ–‡ä¸­å¿ƒã€‚</li>
  <li>å°æ–¼å¥‡æ•¸é•·åº¦ä¸­å¿ƒä½¿ç”¨ expand(i, i)</li>
  <li>å¶æ•¸é•·åº¦ä½¿ç”¨ expand(i, i+1)</li>
  <li>å¾ä¸­å¿ƒå¾€å¤–æ“´å±•ä¸¦çµ±è¨ˆå›æ–‡æ¬¡æ•¸</li>
</ul>
<h2>â±ï¸ æ™‚é–“èˆ‡ç©ºé–“è¤‡é›œåº¦</h2>
<ul>
<li><strong>æ™‚é–“è¤‡é›œåº¦ï¼š</strong>O(nÂ²)ï¼Œæ¯å€‹ä¸­å¿ƒæœ€å¤šæ“´å±• O(n) æ¬¡ï¼Œå…±æœ‰ 2n-1 å€‹ä¸­å¿ƒã€‚</li>
<li><strong>ç©ºé–“è¤‡é›œåº¦ï¼š</strong>O(1)ï¼Œåªä½¿ç”¨å¸¸æ•¸é¡å¤–è®Šæ•¸ã€‚</li>
</ul>

<h2>ğŸ’¡ Python ç¨‹å¼ç¢¼</h2>
<pre class="code-block" id="code">
<span id="line1">class Solution:</span>
<span id="line2">    def countSubstrings(self, s: str) -> int:</span>
<span id="line3">        def expand(l, r):</span>
<span id="line4">            count = 0</span>
<span id="line5">            while l >= 0 and r < len(s) and s[l] == s[r]:</span>
<span id="line6">                count += 1</span>
<span id="line7">                l -= 1</span>
<span id="line8">                r += 1</span>
<span id="line9">            return count</span>
<span id="line10">        total = 0</span>
<span id="line11">        for i in range(len(s)):</span>
<span id="line12">            total += expand(i, i)</span>
<span id="line13">            total += expand(i, i+1)</span>
<span id="line14">        return total</span>
</pre>

<h2>ğŸŒ€ è¦–è¦ºåŒ–æ“´å±•ä¸­å¿ƒ</h2>
<div class="window-row" id="windowRow"></div>
<div class="pointer-row" id="pointerRow"></div>
<div class="state-box" id="expandLabel">ğŸ” Expand: -</div>
<div class="state-box">
  total: <span id="total">0</span>
</div>
<p style="text-align:center;">
  <button onclick="nextStep()">ä¸‹ä¸€æ­¥</button>
  <button onclick="reset()">é‡ç½®</button>
</p>

<script>
const s = "aaa";
let total = 0;
let center = 0;
let stage = 0;
let l = 0, r = 0;
let active = true;

function highlight(lineNum) {
  for (let i = 1; i <= 14; i++) {
    document.getElementById("line" + i).classList.remove("highlight");
  }
  if (lineNum) document.getElementById("line" + lineNum).classList.add("highlight");
}

function render() {
  const win = document.getElementById("windowRow");
  const ptr = document.getElementById("pointerRow");
  const tot = document.getElementById("total");
  win.innerHTML = "";
  ptr.innerHTML = "";

  for (let i = 0; i < s.length; i++) {
    const cell = document.createElement("div");
    cell.className = "cell";
    if (i === l || i === r) cell.classList.add("match");
    if (i === center) cell.classList.add("center");
    cell.textContent = s[i];
    win.appendChild(cell);

    const label = document.createElement("div");
    label.className = "label";
    if (i === l && i === r) label.innerHTML = "L/R";
    else if (i === l) label.innerHTML = "L";
    else if (i === r) label.innerHTML = "R";
    else label.innerHTML = "&nbsp;";
    ptr.appendChild(label);
  }
  tot.textContent = total;
}

function nextStep() {
  if (!active) return;

  highlight(5);
  if (l >= 0 && r < s.length && s[l] === s[r]) {
    highlight(6);
    total++;
    document.getElementById("expandLabel").textContent = `ğŸ” Expand: s[${l}..${r}] = \"${s.slice(l, r+1)}\" âœ…`;;
    l--; r++;
  } else {
    stage++;
    if (stage === 1) {
      center++;
      if (center >= s.length) {
        active = false;
        return;
      }
      highlight(12);
      document.getElementById("expandLabel").textContent = `ğŸ” Expand: å¥‡æ•¸ä¸­å¿ƒ i=${center}`;
      render();
      l = center; r = center;
    } else if (stage === 2) {
      highlight(13);
      document.getElementById("expandLabel").textContent = `ğŸ” Expand: å¶æ•¸ä¸­å¿ƒ i=${center}`;
      render();
      l = center; r = center + 1;
    } else {
      stage = 0;
    }
  }
  render();
}

function reset() {
  center = 0;
  stage = 1;
  l = center;
  r = center;
  total = 0;
  active = true;
  highlight(null);
  document.getElementById("expandLabel").textContent = `ğŸ” Expand: -`;
  render();
}

window.onload = reset;
</script>

</body>
</html>
