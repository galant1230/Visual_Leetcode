<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>LeetCode 5 - Longest Palindromic Substring è¦–è¦ºåŒ–æ•™å­¸</title>
  <style>
    body { font-family: sans-serif; background: #f5f7fa; padding: 2rem; }
    h1 { text-align: center; color: #007acc; }
    .section {
      max-width: 900px; margin: 1rem auto; background: white; 
      padding: 1.5rem 2rem; border-radius: 10px; 
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    pre {
      background: #272822; color: #f8f8f2; padding: 1rem; 
      border-radius: 6px; overflow-x: auto; font-family: monospace;
    }
    .code-line { padding: 2px 0; }
    .active-code { background: #444; color: white; }
    .tips {
      background: #fef7dc; padding: 1rem; border-left: 6px solid #f1c40f; 
      border-radius: 6px; margin-top: 1rem;
    }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.75rem; text-align: center; }
    .btn-group { text-align: center; margin-top: 1rem; }
    button {
      background: #007acc; color: white; padding: 10px 16px; 
      border: none; border-radius: 6px; cursor: pointer; margin: 0.5rem;
    }
    .palindrome-display {
      text-align: center;
      font-family: monospace;
      font-size: 1.3rem;
      margin-top: 1rem;
    }
    .center-box {
      display: flex;
      justify-content: center;
      margin-top: 1rem;
    }
    .center-item {
      padding: 8px 12px;
      margin: 4px;
      border: 1px solid #ccc;
      border-radius: 4px;
      background: #ecf0f1;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h1>LeetCode 5 - Longest Palindromic Substring è¦–è¦ºåŒ–æ•™å­¸</h1>

<div class="section">
  <h2>ğŸ“– é¡Œç›®æè¿°</h2>
  <p>
    çµ¦å®šä¸€å€‹å­—ä¸² <code>s</code>ï¼Œè«‹å›å‚³åœ¨ <code>s</code> ä¸­æœ€é•·çš„å›æ–‡å­å­—ä¸²ã€‚å¦‚æœæœ‰å¤šå€‹ç­”æ¡ˆï¼Œå‡å¯å›å‚³å…¶ä¸­ä¸€å€‹ã€‚
  </p>
  <p>
    <strong>ç¯„ä¾‹ 1ï¼š</strong> s = "babad" â†’ è¼¸å‡ºï¼š"bab" ï¼ˆ"aba" ä¹Ÿæ˜¯æ­£ç¢ºç­”æ¡ˆï¼‰<br>
    <strong>ç¯„ä¾‹ 2ï¼š</strong> s = "cbbd" â†’ è¼¸å‡ºï¼š"bb"
  </p>
  <p>
    <strong>ç´„æŸï¼š</strong> 1 <= s.length <= 1000ï¼Œs åªåŒ…å«æ•¸å­—å’Œè‹±æ–‡å­—æ¯ã€‚
  </p>
</div>

<div class="section">
  <h2>ğŸ§  è§£é¡Œæ€è·¯ - ä¸­å¿ƒæ“´å±•æ³•</h2>
  <p>
    å°æ–¼æ¯å€‹ç´¢å¼• <code>i</code>ï¼Œæˆ‘å€‘åˆ†åˆ¥ä»¥å®ƒä½œç‚ºä¸­å¿ƒå‘å¤–æ“´å±•ï¼Œä»¥ç²å–å¥‡æ•¸é•·åº¦å›æ–‡ï¼›åŒæ™‚ä¹Ÿä»¥ <code>i</code> èˆ‡ <code>i+1</code> ç‚ºä¸­å¿ƒä¾†æ“´å±•å¶æ•¸é•·åº¦å›æ–‡ã€‚æŒçºŒæ›´æ–°ç›®å‰ç™¼ç¾çš„æœ€é•·å›æ–‡å­å­—ä¸²ï¼Œæœ€å¾Œå›å‚³çµæœã€‚
  </p>
  <ul>
    <li>å®šç¾© <code>expand(l, r)</code> å‡½å¼ï¼šå¾ä¸­å¿ƒé–‹å§‹ï¼Œå‘å·¦å³æ“´å±•ï¼Œç›´åˆ°ä¸å†æ˜¯å›æ–‡ï¼Œè¿”å›æ“´å±•å¾Œçš„å›æ–‡å­å­—ä¸²ã€‚</li>
    <li>å°æ¯å€‹ç´¢å¼• <code>i</code>ï¼Œåˆ†åˆ¥æª¢æŸ¥å¥‡æ•¸èˆ‡å¶æ•¸æƒ…æ³ï¼Œæ›´æ–°æœ€é•·å›æ–‡ã€‚</li>
  </ul>
  <p>
    æ­¤æ–¹æ³•æ™‚é–“è¤‡é›œåº¦ç‚º O(nÂ²)ï¼ˆæ¯å€‹ç´¢å¼•æœ€å¤šé€²è¡Œ O(n) æ¬¡æ“´å±•ï¼‰ï¼Œç©ºé–“è¤‡é›œåº¦ç‚º O(1)ã€‚
  </p>
</div>

<div class="section">
  <h2>ğŸ”¢ äº’å‹•æ¨¡æ“¬ (ä¸­å¿ƒæ“´å±•éç¨‹)</h2>
  <div class="btn-group">
    <label>è¼¸å…¥å­—ä¸² sï¼š<input type="text" id="inputStr" value="babad"></label>
    <button onclick="startSimulation()">é–‹å§‹æ¨¡æ“¬</button>
    <button onclick="nextStep()">ä¸‹ä¸€æ­¥</button>
  </div>
  <p id="simOutput" style="text-align:center; font-weight:bold;">æ¨¡æ“¬ç‹€æ…‹é¡¯ç¤º</p>
  <div class="center-box" id="centerBox"></div>
  <div class="palindrome-display" id="palindromeDisplay">ç›®å‰æœ€é•·å›æ–‡ï¼š""</div>
</div>

<div class="section">
  <h2>ğŸ’» ç¨‹å¼ç¢¼å±•ç¤º (Python è§£æ³•)</h2>
  <pre id="codeBox">
class Solution:
    def longestPalindrome(self, s: str) -> str:
        def expand(l, r):
            while l >= 0 and r < len(s) and s[l] == s[r]:
                l -= 1
                r += 1
            return s[l+1:r]
    
        result = ""
        for i in range(len(s)):
            sub1 = expand(i, i)      # å¥‡æ•¸é•·åº¦å›æ–‡
            if len(sub1) > len(result):
                result = sub1
            
            sub2 = expand(i, i+1)    # å¶æ•¸é•·åº¦å›æ–‡
            if len(sub2) > len(result):
                result = sub2
        
        return result
  </pre>
  <div class="tips">
    ğŸ’¡ å°æŠ€å·§ï¼šå°æ¯å€‹ç´¢å¼•åˆ†åˆ¥å˜—è©¦å¥‡å¶ä¸­å¿ƒæ“´å±•ï¼Œä¸¦æŒçºŒæ›´æ–°æœ€é•·å›æ–‡ï¼Œç†è§£æ“´å±•éç¨‹æœ‰åŠ©æ–¼æŒæ¡å›æ–‡çš„ç‰¹æ€§ã€‚
  </div>
</div>

<div class="section">
  <h2>â±ï¸ æ™‚é–“èˆ‡ç©ºé–“è¤‡é›œåº¦</h2>
  <table>
    <tr>
      <th>è¤‡é›œåº¦é¡å‹</th>
      <th>åˆ†æ</th>
      <th>Big-O</th>
    </tr>
    <tr>
      <td>æ™‚é–“è¤‡é›œåº¦</td>
      <td>å°æ¯å€‹ç´¢å¼•é€²è¡Œæ“´å±•ï¼Œæœ€å£æƒ…æ³ O(n) æ¬¡æ¯”è¼ƒ</td>
      <td>O(nÂ²)</td>
    </tr>
    <tr>
      <td>ç©ºé–“è¤‡é›œåº¦</td>
      <td>åªä½¿ç”¨å¸¸æ•¸é¡å¤–è®Šæ•¸</td>
      <td>O(1)</td>
    </tr>
  </table>
</div>

<script>
let sStr = "";
let simIndex = 0;
let phase = 0; // 0: è™•ç†å¥‡æ•¸å›æ–‡, 1: è™•ç†å¶æ•¸å›æ–‡, 2: å®Œæˆç•¶å‰ç´¢å¼•, ç§»è‡³ä¸‹ä¸€å€‹ç´¢å¼•
let currentCenter = 0;
let currentLongest = "";
let simOutput = document.getElementById("simOutput");
let centerBox = document.getElementById("centerBox");
let palindromeDisplay = document.getElementById("palindromeDisplay");
let simulationData = [];  // å­˜å„²æ‰€æœ‰ä¸­å¿ƒæ“´å±•æ­¥é©Ÿï¼ˆæ¨¡æ“¬ç”¨ï¼‰

// expand å‡½å¼æ¨¡æ“¬ï¼šè¿”å›å›æ–‡å­å­—ä¸²ï¼ŒåŒæ™‚å­˜ä¸‹æ“´å±•çš„éç¨‹
function expand(l, r) {
  let steps = [];
  while (l >= 0 && r < sStr.length && sStr[l] === sStr[r]) {
    steps.push({l: l, r: r, substr: sStr.substring(l, r+1)});
    l--;
    r++;
  }
  return {palindrome: sStr.substring(l+1, r), steps: steps};
}

function startSimulation() {
  sStr = document.getElementById("inputStr").value;
  simIndex = 0;
  phase = 0;
  currentCenter = 0;
  currentLongest = "";
  simulationData = [];
  centerBox.innerHTML = "";
  palindromeDisplay.innerText = `ç›®å‰æœ€é•·å›æ–‡ï¼š""`;
  simOutput.innerText = `é–‹å§‹æ¨¡æ“¬ï¼šè™•ç†å­—ä¸² "${sStr}"`;
  highlightCode(null);
}

// ä¸‹ä¸€æ­¥ï¼šæ¨¡æ“¬è™•ç†ç•¶å‰ç´¢å¼•çš„ä¸­å¿ƒæ“´å±•ï¼ˆå…ˆå¥‡æ•¸å†å¶æ•¸ï¼‰
function nextStep() {
  if (simIndex >= sStr.length) {
    simOutput.innerText = "æ¨¡æ“¬å®Œæˆï¼";
    highlightCode("return");
    return;
  }
  // å¦‚æœç¬¬ä¸€æ¬¡é€²å…¥è©²ç´¢å¼•ï¼Œæº–å‚™æ•¸æ“š
  if (simulationData.length === 0) {
    // æ¨¡æ“¬å¥‡æ•¸ä¸­å¿ƒæ“´å±•
    let res1 = expand(simIndex, simIndex);
    // æ¨¡æ“¬å¶æ•¸ä¸­å¿ƒæ“´å±•
    let res2 = expand(simIndex, simIndex + 1);
    simulationData = [
      {type: "å¥‡æ•¸", data: res1},
      {type: "å¶æ•¸", data: res2}
    ];
    currentCenter = 0;
    simOutput.innerText = `è™•ç†ç´¢å¼• ${simIndex} (${sStr[simIndex]}): é–‹å§‹å¥‡æ•¸ä¸­å¿ƒæ“´å±•`;
    highlightCode("expand");
    displayCenter(simulationData[currentCenter].data.steps, simulationData[currentCenter].type);
    return;
  }
  // è‹¥é‚„åœ¨åŒä¸€ä¸­å¿ƒæ“´å±•éç¨‹ä¸­ï¼Œé¡¯ç¤ºä¸‹ä¸€å€‹æ­¥é©Ÿ
  let currentData = simulationData[currentCenter].data.steps;
  if (currentData && currentData.length > 0) {
    let stepData = currentData.shift();
    simOutput.innerText = `${simulationData[currentCenter].type}ä¸­å¿ƒæ“´å±•ï¼šl = ${stepData.l}, r = ${stepData.r}, å›æ–‡ = "${stepData.substr}"`;
    displayCenter([stepData], simulationData[currentCenter].type);
    // æ›´æ–°æœ€é•·å›æ–‡çµæœ
    if (stepData.substr.length > currentLongest.length) {
      currentLongest = stepData.substr;
      palindromeDisplay.innerText = `ç›®å‰æœ€é•·å›æ–‡ï¼š "${currentLongest}"`;
    }
    return;
  } else {
    // ç•¶å‰ä¸­å¿ƒæ“´å±•å®Œæˆï¼Œè‹¥é‚„æœ‰ä¸‹ä¸€ç¨®ä¸­å¿ƒæ“´å±•å‰‡åˆ‡æ›ï¼Œå¦å‰‡ç§»è‡³ä¸‹ä¸€ç´¢å¼•
    if (currentCenter < simulationData.length - 1) {
      currentCenter++;
      simOutput.innerText = `è™•ç†ç´¢å¼• ${simIndex}: åˆ‡æ›åˆ° ${simulationData[currentCenter].type}ä¸­å¿ƒæ“´å±•`;
      highlightCode("expand");
      displayCenter(simulationData[currentCenter].data.steps, simulationData[currentCenter].type);
      return;
    } else {
      // å®Œæˆç•¶å‰ç´¢å¼•çš„æ‰€æœ‰æ“´å±•ï¼Œç§»è‡³ä¸‹ä¸€å€‹ç´¢å¼•
      simIndex++;
      simulationData = [];
      simOutput.innerText = `å®Œæˆç´¢å¼• ${simIndex-1}ï¼Œç§»è‡³ç´¢å¼• ${simIndex}`;
      highlightCode("loop");
      return;
    }
  }
}

// å°‡ä¸­å¿ƒæ“´å±•çš„æ­¥é©Ÿé¡¯ç¤ºåœ¨ centerBox ä¸­
function displayCenter(steps, type) {
  centerBox.innerHTML = "";
  if (steps.length === 0) {
    const div = document.createElement("div");
    div.className = "center-item";
    div.innerText = `${type}ä¸­å¿ƒæ“´å±•çµæŸ`;
    centerBox.appendChild(div);
  } else {
    steps.forEach(step => {
      const div = document.createElement("div");
      div.className = "center-item";
      div.innerText = `[l=${step.l}, r=${step.r}] : "${step.substr}"`;
      centerBox.appendChild(div);
    });
  }
}

function highlightCode(context) {
  const codeBox = document.getElementById("codeBox");
  const lines = codeBox.innerText.split("\n");
  let newHTML = "";
  for (let i = 0; i < lines.length; i++) {
    let line = lines[i];
    let id = "";
    if (context === "expand" && line.includes("def expand(l, r):")) {
      id = 'id="hl"';
    } else if (context === "loop" && line.includes("for i in range(len(s)):" )) {
      id = 'id="hl"';
    } else if (context === "return" && line.includes("return result")) {
      id = 'id="hl"';
    }
    newHTML += `<div class="code-line" ${id}>${line}</div>`;
  }
  codeBox.innerHTML = newHTML;
}
</script>

</body>
</html>
