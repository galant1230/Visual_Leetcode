<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>Valid Palindrome è¦–è¦ºåŒ–æ•™å­¸</title>
  <style>
    body { font-family: sans-serif; background: #f5f7fa; padding: 2rem; }
    h1 { text-align: center; color: #007acc; }
    .section {
      max-width: 900px;
      margin: 1rem auto;
      background: white;
      padding: 1.5rem 2rem;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .char-box {
      display: flex;
      flex-wrap: nowrap;
      justify-content: center;
      margin: 1rem 0;
      font-family: monospace;
      font-size: 1.2rem;
    }
    .char {
      padding: 8px;
      margin: 2px;
      border: 1px solid #ccc;
      border-radius: 4px;
      min-width: 20px;
      text-align: center;
    }
    .pointer {
      font-size: 0.9rem;
      color: white;
      background: #e74c3c;
      padding: 2px 4px;
      border-radius: 4px;
      position: relative;
      top: -10px;
      margin: 0 4px;
    }
    .code-line { padding: 2px 0; font-family: monospace; }
    .active-code { background: #444; color: white; }
    #codeBox {
      background: #272822;
      color: #f8f8f2;
      padding: 1rem;
      border-radius: 6px;
      margin-top: 1rem;
      overflow-x: auto;
    }
    .tips {
      background: #fef7dc;
      padding: 1rem;
      border-left: 6px solid #f1c40f;
      border-radius: 6px;
      margin-top: 1rem;
    }
    table {
      width: 100%; 
      border-collapse: collapse; 
      margin-top: 1rem;
    }
    th, td {
      border: 1px solid #ccc; 
      padding: 0.75rem; 
      text-align: center;
    }
    .btn-group { text-align: center; margin-top: 1rem; }
    button {
      background: #007acc;
      color: white;
      padding: 10px 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin: 0.5rem;
    }
  </style>
</head>
<body>

<h1>Valid Palindrome è¦–è¦ºåŒ–æ•™å­¸</h1>

<div class="section">
  <h2>ğŸ“Œ é¡Œç›®æè¿°</h2>
  <p>
    çµ¦å®šä¸€å€‹å­—ä¸² <code>s</code>ï¼Œå°‡æ‰€æœ‰å¤§å¯«å­—æ¯è½‰æˆå°å¯«ï¼Œä¸¦ç§»é™¤æ‰€æœ‰éå­—æ¯æ•¸å­—çš„å­—ç¬¦ï¼Œæª¢æŸ¥å‰©ä¸‹çš„å­—ä¸²æ˜¯å¦ç‚ºå›æ–‡ï¼ˆæ­£è®€èˆ‡åè®€éƒ½ç›¸åŒï¼‰ã€‚
  </p>
  <p>
    <strong>ç¯„ä¾‹ï¼š</strong><br>
    Input: "A man, a plan, a canal: Panama" â†’ Output: true<br>
    Input: "race a car" â†’ Output: false
  </p>
</div>

<div class="section">
  <h2>ğŸ§  è§£é¡Œæ€è·¯</h2>
  <p>
    åˆ©ç”¨å·¦å³æŒ‡é‡ï¼ˆTwo Pointersï¼‰çš„æ–¹å¼ï¼š
  </p>
  <ol>
    <li>å®šç¾©å·¦æŒ‡é‡ <code>l</code> æŒ‡å‘å­—ä¸²èµ·å§‹ï¼Œå³æŒ‡é‡ <code>r</code> æŒ‡å‘å­—ä¸²æœ«å°¾ã€‚</li>
    <li>ç•¶ <code>s[l]</code> æˆ– <code>s[r]</code> ä¸æ˜¯å­—æ¯æˆ–æ•¸å­—æ™‚ï¼Œåˆ†åˆ¥ç§»å‹•æŒ‡é‡è·³éã€‚</li>
    <li>æ¯”è¼ƒå…©æŒ‡é‡çš„å­—ç¬¦ï¼ˆè½‰å°å¯«å¾Œï¼‰ï¼Œè‹¥ä¸ç›¸ç­‰å‰‡è¿”å› falseï¼›è‹¥ç›¸ç­‰å‰‡ç¹¼çºŒç§»å‹•æŒ‡é‡å‘ä¸­é–“ã€‚</li>
    <li>è‹¥æ•´å€‹éç¨‹éƒ½åŒ¹é…ï¼Œå‰‡ç‚ºå›æ–‡ï¼Œè¿”å› trueã€‚</li>
  </ol>
  <p>
    æ­¤æ–¹æ³•æ™‚é–“è¤‡é›œåº¦ç‚º O(n)ï¼Œç©ºé–“è¤‡é›œåº¦ç‚º O(1)ã€‚
  </p>
</div>

<div class="section">
  <h2>ğŸ”¢ é€æ­¥æ¨¡æ“¬ (å¿«æ…¢æŒ‡é‡è¦–è¦ºåŒ–)</h2>
  <div class="btn-group">
    <label>è¼¸å…¥å­—ä¸² sï¼š<input type="text" id="inputStr" value="A man, a plan, a canal: Panama"></label>
    <button onclick="startSimulation()">é–‹å§‹æ¨¡æ“¬</button>
    <button onclick="nextStep()">ä¸‹ä¸€æ­¥</button>
  </div>
  <div class="char-box" id="charBox"></div>
  <p id="simOutput" style="text-align:center; font-weight:bold;">æ¨¡æ“¬ç‹€æ…‹</p>
</div>

<div class="section">
  <h2>ğŸ’» ç¨‹å¼ç¢¼å±•ç¤º (Python è§£æ³•)</h2>
  <pre id="codeBox">
class Solution:
    def isPalindrome(self, s: str) -> bool:
        l = 0
        r = len(s) - 1

        while l < r:
            if not s[l].isalnum():
                l += 1
            elif not s[r].isalnum():
                r -= 1
            elif s[l].lower() == s[r].lower():
                l += 1
                r -= 1
            else:
                return False

        return True
  </pre>
  <div class="tips">
    ğŸ’¡ å°æŠ€å·§ï¼šåˆ©ç”¨ Python å…§å»ºçš„ <code>isalnum()</code> èˆ‡ <code>lower()</code> æ–¹æ³•å¯ä»¥è¼•é¬†è™•ç†éå­—æ¯æ•¸å­—å­—ç¬¦èˆ‡å¤§å°å¯«è½‰æ›ã€‚
  </div>
</div>

<div class="section">
  <h2>â± æ™‚é–“èˆ‡ç©ºé–“è¤‡é›œåº¦</h2>
  <table>
    <tr>
      <th>åˆ†æé …ç›®</th>
      <th>èªªæ˜</th>
      <th>Big-O</th>
    </tr>
    <tr>
      <td>æ™‚é–“è¤‡é›œåº¦</td>
      <td>æ¯å€‹å­—ç¬¦æœ€å¤šè™•ç†ä¸€æ¬¡</td>
      <td>O(n)</td>
    </tr>
    <tr>
      <td>ç©ºé–“è¤‡é›œåº¦</td>
      <td>åªä½¿ç”¨å…©å€‹æŒ‡é‡</td>
      <td>O(1)</td>
    </tr>
  </table>
</div>

<script>
let s = "";
let l = 0, r = 0, simStep = 0;
let processed = "";
const simOutput = document.getElementById("simOutput");
const charBox = document.getElementById("charBox");

function startSimulation() {
  s = document.getElementById("inputStr").value;
  l = 0;
  r = s.length - 1;
  simStep = 0;
  updateDisplay();
  simOutput.innerText = `é–‹å§‹æ¨¡æ“¬ï¼šl = ${l}, r = ${r}`;
  highlightCode(null);
}

function nextStep() {
  if (l >= r) {
    simOutput.innerText = "æ¨¡æ“¬å®Œæˆï¼šå›æ–‡ï¼";
    highlightCode("return");
    return;
  }
  
  // å¦‚æœå·¦é‚Šä¸æ˜¯å­—æ¯æ•¸å­—ï¼Œè·³é
  if (!isAlnum(s[l])) {
    simOutput.innerText = `è·³ééå­—æ¯æ•¸å­—: s[${l}] = "${s[l]}"`;
    l++;
    updateDisplay();
    return;
  }
  // å¦‚æœå³é‚Šä¸æ˜¯å­—æ¯æ•¸å­—ï¼Œè·³é
  if (!isAlnum(s[r])) {
    simOutput.innerText = `è·³ééå­—æ¯æ•¸å­—: s[${r}] = "${s[r]}"`;
    r--;
    updateDisplay();
    return;
  }
  
  // æ¯”è¼ƒå·¦å³å­—ç¬¦
  let leftChar = s[l].toLowerCase();
  let rightChar = s[r].toLowerCase();
  if (leftChar === rightChar) {
    simOutput.innerText = `åŒ¹é…: s[${l}] = "${s[l]}", s[${r}] = "${s[r]}"`;
    l++;
    r--;
    updateDisplay();
    highlightCode("match");
  } else {
    simOutput.innerText = `ä¸åŒ¹é…: s[${l}] = "${s[l]}", s[${r}] = "${s[r]}" â†’ éå›æ–‡`;
    highlightCode("fail");
    return;
  }
}

function isAlnum(c) {
  return /[A-Za-z0-9]/.test(c);
}

function updateDisplay() {
  charBox.innerHTML = "";
  for (let i = 0; i < s.length; i++) {
    const span = document.createElement("span");
    span.className = "char";
    span.innerText = s[i];
    if (i === l && i === r) { // ä¸­é–“é‡åˆ
      span.style.background = "#e67e22";
      span.style.color = "white";
    } else if (i === l) {
      const pointer = document.createElement("div");
      pointer.className = "pointer";
      pointer.innerText = "â† l";
      span.appendChild(pointer);
    } else if (i === r) {
      const pointer = document.createElement("div");
      pointer.className = "pointer";
      pointer.innerText = "r â†’";
      span.appendChild(pointer);
    }
    charBox.appendChild(span);
  }
}

function highlightCode(context) {
  const codeBox = document.getElementById("codeBox");
  const lines = codeBox.innerText.split("\n");
  let newHTML = "";
  for (let i = 0; i < lines.length; i++) {
    let line = lines[i];
    let id = "";
    // æ ¹æ“š context é€²è¡Œé«˜äº®é¡¯ç¤º
    if (context === "match" && line.includes("elif s[l].lower() == s[r].lower():")) {
      id = 'id="hl"';
    } else if (context === "fail" && line.includes("else:  # è‹¥ä¸ç›¸ç­‰ï¼Œå‰‡ä¸æ˜¯å›æ–‡")) {
      id = 'id="hl"';
    } else if (context === "return" && line.includes("return True")) {
      id = 'id="hl"';
    }
    newHTML += `<div class="code-line" ${id}>${line}</div>`;
  }
  codeBox.innerHTML = newHTML;
}
</script>

</body>
</html>
